<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>python系统指令</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="https://hjrgrf.github.io/stylesheets/normalize.css" media="screen">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="https://hjrgrf.github.io/stylesheets/stylesheet.css" media="screen">
<link rel="stylesheet" type="text/css" href="https://hjrgrf.github.io/stylesheets/github-light.css" media="screen">
</head>
<body>
<section class="page-header">
  <h1 class="project-name">Jared-H's Blog</h1>
  <h2 class="project-tagline">python系统指令</h2>
  <a href="https://hjrgrf.github.io" class="btn"><< Home</a>
  <a href="https://hjrgrf.github.io/my_blogs/blogs_list.html" class="btn">< My Blogs</a>
</section>
<section class="main-content">
<h1>Python 中调用系统命令</h1>
<h2>第一种</h2>
<p><code>os.system</code> 在一个子终端中运行系统命令</p>
<p>仅仅在一个子终端运行系统命令，而不能获取命令执行后的返回信息</p>
<blockquote>
<p>system(command) -&gt; exit_status</p>
<p>Execute the command (a string) in a subshell.</p>
</blockquote>
<p>如果再命令行下执行，结果直接打印出来</p>
<pre><code>&gt;&gt;&gt;os.system('ls')
04101419778.CHM   bash      document    media      py-django   video
11.wmv            books     downloads   Pictures  python
all-20061022      Desktop   Examples    project    tools
</code></pre>

<h2>第二种</h2>
<p><code>os.popen</code>该方法不但执行命令还返回执行后的信息对象</p>
<blockquote>
<p>popen(command [, mode='r' [, bufsize]]) -&gt; pipe</p>
<p>Open a pipe to/from a command returning a file object.</p>
</blockquote>
<p>例如：</p>
<pre><code>&gt;&gt;&gt;tmp = os.popen('ls *.py').readlines()
&gt;&gt;&gt;tmp

Out[21]:
['dump_db_pickle.py ',
'dump_db_pickle_recs.py ',
'dump_db_shelve.py ',
'initdata.py ',
'__init__.py ',
'make_db_pickle.py ',
'make_db_pickle_recs.py ',
'make_db_shelve.py ',
'peopleinteract_query.py ',
'reader.py ',
'testargv.py ',
'teststreams.py ',
'update_db_pickle.py ',
'writer.py ']
</code></pre>

<p>好处在于：将返回的结果赋于一变量，便于程序的处理。</p>
<h2>第三种</h2>
<p>使用模块subprocess</p>
<pre><code>&gt;&gt;&gt;import subprocess
&gt;&gt;&gt;subprocess.call ([&quot;cmd&quot;, &quot;arg1&quot;, &quot;arg2&quot;],shell=True)
</code></pre>

<p>获取返回和输出:</p>
<pre><code>import subprocess
p = subprocess.Popen('ls', shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
for line in p.stdout.readlines():
    print line,
retval = p.wait()
</code></pre>

<h2>第四种</h2>
<p>使用模块commands模块</p>
<pre><code>&gt;&gt;&gt;import commands
&gt;&gt;&gt;dir(commands)
['__all__', '__builtins__', '__doc__', '__file__', '__name__', 'getoutput', 'getstatus','getstatusoutput', 'mk2arg', 'mkarg']
&gt;&gt;&gt;commands.getoutput(&quot;date&quot;)
'Wed Jun 10 19:39:57 CST 2009'
&gt;&gt;&gt;
&gt;&gt;&gt; commands.getstatusoutput(&quot;date&quot;)
(0, 'Wed Jun 10 19:40:41 CST 2009')
</code></pre>

<p>注意： 当执行命令的参数或者返回中包含了中文文字，那么建议使用subprocess，如果使用os.popen则会出现下面的错误:</p>
<pre><code>Traceback (most recent call last):
  File &quot;./test1.py&quot;, line 56, in &lt;module&gt;
    main()
  File &quot;./test1.py&quot;, line 45, in main
    fax.sendFax()
  File &quot;./mailfax/Fax.py&quot;, line 13, in sendFax
    os.popen(cmd)
UnicodeEncodeError: 'ascii' codec can't encode characters in position 46-52: ordinal not inrange(128)
</code></pre>

<p>关于本文更多的延伸阅读地址：</p>
<p><a href="http://zh-cn.how-to.mobi/index.php?id=89228">http://zh-cn.how-to.mobi/index.php?id=89228</a></p>
<p><a href="http://www.javaeye.com/topic/406623">http://www.javaeye.com/topic/406623</a></p>
<footer class="site-footer">
<span class="site-footer-owner"><a href="https://hjrgrf.github.io">Back Home</a></span>
<span class="site-footer-owner"><a href="https://github.com/hjrgrf/hjrgrf.github.com">Jared-H.Homepage</a> is maintained by <a href="https://github.com/hjrgrf">Jared H</a> (2016).</span>

<span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
</footer>

</section>
</body>
</html>
<!-- This document was created with MarkdownPad, the Markdown editor for Windows (http://markdownpad.com) -->
